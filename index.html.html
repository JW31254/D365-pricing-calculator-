<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern D365 & Power Platform Pricing Calculators</title>
    <style>
        /* --- Modern Base & Theme --- */
        :root {
            --bg-dark: #111827; --bg-card: rgba(31, 41, 55, 0.6); --border-color: rgba(75, 85, 99, 0.6);
            --text-primary: #f3f4f6; --text-secondary: #9ca3af; --accent-blue: #3b82f6; --accent-purple: #8b5cf6;
            --accent-teal: #14b8a6; --accent-red: #ef4444; --accent-green: #22c55e; --hover-bg-card: rgba(55, 65, 81, 0.7);
            --mouse-x: 50%; --mouse-y: 50%;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background-color: var(--bg-dark); background-image: radial-gradient( 800px circle at var(--mouse-x) var(--mouse-y), rgba(59, 130, 246, 0.1), transparent 40% ), radial-gradient( 1200px circle at calc(100% - var(--mouse-x)) calc(100% - var(--mouse-y)), rgba(139, 92, 246, 0.1), transparent 50% ); background-attachment: fixed; color: var(--text-primary); line-height: 1.6; padding: 30px 20px; overflow-x: hidden; transition: background 0.2s linear; }
        .app-container { max-width: 900px; margin: 20px auto; }
        .page-section { width: 100%; opacity: 0; visibility: hidden; transition: opacity 0.4s ease-in-out, visibility 0s linear 0.4s; position: absolute; left: 0; right: 0; padding: 0 20px; margin: 0 auto; max-width: 900px; }
        .page-section.active { opacity: 1; visibility: visible; transition: opacity 0.4s ease-in-out; position: relative; }
        h1, h2, h3 { color: var(--text-primary); margin-bottom: 0.75em; font-weight: 600; }
        h1 { font-size: 2.25rem; text-align: center; margin-bottom: 0.5em; }
        h2 { font-size: 1.5rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.4em; }
        h3 { font-size: 1.1rem; color: var(--text-secondary); font-weight: 500; margin-bottom: 0.5em; }
        p { color: var(--text-secondary); margin-bottom: 1em; font-size: 0.95rem; }
        strong { color: var(--text-primary); font-weight: 600; }
        .card { background: var(--bg-card); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px rgba(0, 0, 0, 0.15); background: var(--hover-bg-card); }
        .pricing { background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.3)); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(99, 102, 241, 0.5); }
        .pricing h2, .pricing h3 { color: var(--text-primary); border-bottom: none; }
        .pricing .note { color: rgba(243, 244, 246, 0.8); }
        .pricing .breakdown { border-top: 1px solid rgba(243, 244, 246, 0.2); }
        .pricing .total-price { font-size: 2.5rem; text-shadow: 0 2px 4px rgba(0,0,0,0.2); text-align: center; margin-bottom: 15px; }
        .config-card { background-color: rgba(55, 65, 81, 0.5); border-radius: 8px; padding: 20px; border: 1px solid var(--border-color); margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-secondary); font-size: 0.9rem; }
        input[type="number"] { width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; background-color: rgba(55, 65, 81, 0.8); color: var(--text-primary); font-size: 0.95rem; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
        input[type="number"]:focus { border-color: var(--accent-blue); outline: none; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3); }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; } input[type=number] { -moz-appearance: textfield; }
        .radio-group, .checkbox-group { display: flex; flex-direction: column; gap: 12px; }
        .radio-group label, .checkbox-group label { display: flex; align-items: start; gap: 10px; cursor: pointer; font-weight: normal; color: var(--text-primary); font-size: 0.95rem; }
        .radio-group label div, .checkbox-group label div { flex-grow: 1; }
        input[type="radio"], input[type="checkbox"] { width: 1.1em; height: 1.1em; accent-color: var(--accent-purple); cursor: pointer; margin-top: 0.2em; flex-shrink: 0; }
        label.inline-label { display: inline !important; font-weight: normal !important; }
        .btn { display: inline-block; background: linear-gradient(to right, var(--accent-blue), var(--accent-purple)); color: white; text-decoration: none; padding: 12px 24px; border-radius: 8px; font-weight: 500; margin-top: 15px; transition: all 0.3s ease; border: none; cursor: pointer; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .btn:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15); filter: brightness(1.1); }
        .btn:active { transform: translateY(0px) scale(1); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .back-link { display: inline-block; margin-bottom: 25px; color: var(--accent-blue); text-decoration: none; font-weight: 500; cursor: pointer; transition: color 0.2s ease; }
        .back-link:hover { color: var(--accent-teal); text-decoration: underline; }
        .index-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-top: 30px; }
        .calculator-card { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 25px; }
        .calculator-icon { width: 60px; height: 60px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple)); color: white; font-size: 28px; box-shadow: 0 0 15px rgba(99, 102, 241, 0.3); }
        .calculator-desc { margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem; flex-grow: 1; line-height: 1.5; }
        .tooltip { position: relative; display: inline-block; vertical-align: middle; }
        .icon-info { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; background-color: var(--text-secondary); color: var(--bg-dark); border-radius: 50%; font-size: 11px; cursor: help; margin-left: 6px; font-weight: bold; line-height: 1; transition: background-color 0.2s ease; }
         .tooltip:hover .icon-info { background-color: var(--accent-teal); }
        .tooltip .tooltip-text { visibility: hidden; opacity: 0; width: 250px; background-color: #2d3748; color: var(--text-primary); text-align: left; border-radius: 8px; padding: 12px; position: absolute; z-index: 10; bottom: 140%; left: 50%; transform: translateX(-50%); transition: opacity 0.3s ease, visibility 0s linear 0.3s; font-weight: normal; font-size: 0.85rem; line-height: 1.4; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .tooltip .tooltip-text::after { content: ""; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border-width: 6px; border-style: solid; border-color: #2d3748 transparent transparent transparent; }
        .tooltip:hover .tooltip-text, .tooltip:focus-within .tooltip-text { visibility: visible; opacity: 1; transition-delay: 0s; }
        .grid-container-inputs { display: grid; grid-template-columns: 1fr; gap: 30px; }
        @media (min-width: 800px) { .grid-container-inputs { grid-template-columns: 1fr 1fr; } }
        .number-input { display: flex; align-items: center; margin-bottom: 15px; gap: 15px; flex-wrap: wrap; }
        .number-input label { flex: 1 1 auto; margin-bottom: 0; font-weight: normal; color: var(--text-secondary); }
        .number-input input[type="number"] { flex: 0 0 110px; width: 110px; }
        .breakdown { margin-top: 25px; padding-top: 25px; display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px 20px; }
        .breakdown-section { margin-bottom: 0; }
        .breakdown-section h3 { margin: 0 0 8px 0; font-size: 0.9rem; opacity: 0.9; font-weight: 500; color: var(--text-secondary); text-transform: uppercase; }
        .breakdown-section div { font-size: 1rem; font-weight: 600; }
        .breakdown-section small { display: block; opacity: 0.7; font-size: 0.8em; margin-top: 3px; line-height: 1.3; }
        .note { margin-top: 25px; opacity: 0.8; font-size: 0.9rem; text-align: center; color: var(--text-secondary); }
        .warning { background-color: rgba(239, 68, 68, 0.15); color: #fecaca; border-left: 4px solid var(--accent-red); padding: 12px 15px; margin: 15px 0; border-radius: 6px; font-weight: 500; font-size: 0.95rem; }
        .warning strong { color: #fee2e2; }
        .disclaimer { background-color: rgba(245, 158, 11, 0.15); color: #fde68a; border-left: 4px solid #f59e0b; padding: 12px 15px; margin: 20px 0; border-radius: 6px; font-weight: 500; font-size: 0.9rem; }
        .disclaimer strong { color: #fef3c7;}
        .license-input-group { margin-bottom: 15px; }
        .license-input-group label { display: flex; align-items: center; justify-content: space-between; }
        .license-input-group input[type="number"] { width: 80px; flex-shrink: 0; margin-left: 15px; text-align: right; }
        .license-input-group .price-info { font-size: 0.85em; color: var(--text-secondary); margin-left: 10px; flex-shrink: 0; }
        .feature-table-container { margin-top: 25px; }
        .feature-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; background-color: rgba(55, 65, 81, 0.5); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color); }
        .feature-table th, .feature-table td { padding: 8px 10px; text-align: left; border-bottom: 1px solid var(--border-color); }
        .feature-table th { background-color: rgba(75, 85, 99, 0.4); font-weight: 600; text-align: center; }
        .feature-table tr:last-child td { border-bottom: none; }
        .feature-table td:not(:first-child) { text-align: center; }
        .feature-table .check { color: var(--accent-green); font-weight: bold; }
        .feature-table .partial { color: var(--accent-blue); font-style: italic; }
        .feature-table .no-check { color: var(--text-secondary); opacity: 0.6; }
        .index-disclaimer { background-color: rgba(245, 158, 11, 0.15); color: #fde68a; border-left: 4px solid #f59e0b; padding: 15px 20px; margin: 15px 0 30px 0; border-radius: 8px; font-weight: 500; font-size: 0.95rem; text-align: center; }
        .index-disclaimer strong { color: #fef3c7; display: block; margin-bottom: 5px; }
        .attribution { text-align: center; font-size: 0.85rem; color: var(--text-secondary); margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border-color); }
        .attribution a { color: var(--accent-teal); text-decoration: none; }
        .attribution a:hover { text-decoration: underline; }
        @media (max-width: 640px) {
            h1 { font-size: 1.8rem; } h2 { font-size: 1.3rem; }
            .index-grid, .grid-container-inputs, .breakdown { grid-template-columns: 1fr; }
            .breakdown { gap: 15px; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
            .number-input { flex-direction: column; align-items: stretch; gap: 8px; }
            .number-input input[type="number"] { flex-basis: auto; width: 100%; }
            .card { padding: 20px; margin-bottom: 20px; } body { padding: 15px 10px; }
            .app-container { margin: 10px auto; } .page-section { padding: 0 10px; }
            .btn { padding: 10px 18px; font-size: 0.95rem; }
            .radio-group label, .checkbox-group label { align-items: center; }
            input[type="radio"], input[type="checkbox"] { margin-top: 0; }
            .feature-table { font-size: 0.75rem; } .feature-table th, .feature-table td { padding: 6px 8px;}
            .index-disclaimer { font-size: 0.9rem; padding: 12px 15px; }
            .attribution { font-size: 0.8rem; }
        }
    </style>
</head>
<body>

<div class="app-container"> <!-- Main centered container -->

    <!-- Index Page Section -->
    <div id="index-section" class="page-section">
        <h1>D365 & Power Platform Calculators</h1>
        <div class="tagline">Modern Estimation Tools (UK Pricing Focus)</div>
        <div class="index-disclaimer">
            <strong>Work In Progress - Estimates Only</strong>
            This tool provides indicative cost estimations based on UK list prices and representative usage rates. It is intended for guidance only and should not be considered a final quote. Always verify official Microsoft licensing documentation and pricing for your specific region and agreements.
        </div>
        <div class="index-grid">
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="2" y2="22"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg></div> <h2>Dynamics 365 Sales</h2> <div class="calculator-desc">Estimate costs for Sales licenses.</div> <a href="#" onclick="showCalculator('sales-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 6.091A8.984 8.984 0 0 0 12 4c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9"></path><path d="m12 17-2-2 2-2"></path><path d="m17 17-2-2 2-2"></path></svg></div> <h2>D365 Customer Service</h2> <div class="calculator-desc">Estimate costs for Customer Service licenses.</div> <a href="#" onclick="showCalculator('custsvc-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M9.5 14.5 16 21l-2.5-4.5L16 12l-6.5 6.5"></path></svg></div> <h2>D365 Field Service</h2> <div class="calculator-desc">Estimate costs for Field Service & RSO.</div> <a href="#" onclick="showCalculator('fieldsvc-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></div> <h2>Power Apps</h2> <div class="calculator-desc">Estimate costs for Power Apps plans.</div> <a href="#" onclick="showCalculator('powerapps-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg></div> <h2>Power Automate</h2> <div class="calculator-desc">Estimate costs for Power Automate plans.</div> <a href="#" onclick="showCalculator('powerautomate-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"></path></svg></div> <h2>Power Pages</h2> <div class="calculator-desc">Estimate costs for Power Pages capacity.</div> <a href="#" onclick="showCalculator('powerpages-section'); return false;" class="btn">Launch</a> </div>
             <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><polyline points="17 11 19 13 23 9"></polyline></svg></div> <h2>Customer Insights</h2> <div class="calculator-desc">Estimate CI Base/Attach costs and capacity.</div> <a href="#" onclick="showCalculator('ci-section'); return false;" class="btn">Launch</a> </div>
            <div class="card calculator-card"> <div class="calculator-icon"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path><path d="m10 12-1.5 1.5M14 12l1.5 1.5M8.5 8.5v.01M15.5 8.5v.01"></path></svg></div> <h2>Copilot Studio</h2> <div class="calculator-desc">Estimate Copilot Studio message costs.</div> <a href="#" onclick="showCalculator('cs-section'); return false;" class="btn">Launch</a> </div>
        </div>
        <div class="attribution"> Created by <a href="https://www.linkedin.com/in/jack-wicks/" target="_blank" rel="noopener noreferrer">Jack Wicks</a>. </div>
    </div>

    <!-- D365 Sales Calculator -->
     <div id="sales-section" class="page-section">
        <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Dynamics 365 Sales Calculator</h1>
        <form id="salesForm">
            <div class="card"><h2>Sales Licenses (UK Pricing)</h2><p>Enter the number of users required for each license type.</p>
                <div class="config-card">
                    <div class="license-input-group"><label for="salesPremUsers"><div>Premium Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Includes Enterprise + Sales Insights & full Copilot.</span></span></div><div><span class="price-info">(£<span id="price_salesPrem">101.80</span>/u/m)</span><input type="number" id="salesPremUsers" min="0" value="0" step="1"></div></label></div>
                    <div class="license-input-group"><label for="salesEntUsers"><div>Enterprise Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Core SFA, customization, limited Insights, basic Copilot.</span></span></div><div><span class="price-info">(£<span id="price_salesEnt">71.60</span>/u/m)</span><input type="number" id="salesEntUsers" min="0" value="10" step="1"></div></label></div>
                    <div class="license-input-group"><label for="salesProUsers"><div>Professional Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Essential SFA. Cannot mix with Ent/Prem.</span></span></div><div><span class="price-info">(£<span id="price_salesPro">49.00</span>/u/m)</span><input type="number" id="salesProUsers" min="0" value="0" step="1"></div></label></div>
                    <div class="license-input-group"><label for="salesTeamUsers"><div>Team Member Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Lightweight read/write access. See Guide Appendix C.</span></span></div><div><span class="price-info">(£<span id="price_salesTeam">6.00</span>/u/m)</span><input type="number" id="salesTeamUsers" min="0" value="0" step="1"></div></label></div>
                </div>
                <div class="feature-table-container"><h3>Feature Highlights</h3><table class="feature-table"><thead><tr><th>Feature Area</th><th>Premium</th><th>Enterprise</th><th>Professional</th><th>Team Member</th></tr></thead><tbody><tr><td>Core Lead/Opp/Account/Contact Mgt.</td><td class="check">✔</td><td class="check">✔</td><td class="check">✔</td><td class="partial">Read</td></tr><tr><td>Customization (Apps, Forms, Flows)</td><td class="check">✔</td><td class="check">✔</td><td class="partial">Limited</td><td class="no-check">✘</td></tr><tr><td>Sales Insights (Full Suite)</td><td class="check">✔</td><td class="partial">Limited</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Predictive Scoring/Forecasting</td><td class="check">✔</td><td class="partial">Limited</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Full Copilot for Sales</td><td class="check">✔</td><td class="partial">Basic</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Marketing Lists & Quick Campaigns</td><td class="check">✔</td><td class="check">✔</td><td class="check">✔</td><td class="no-check">✘</td></tr></tbody></table></div>
            </div>
            <div class="card pricing"><h2>Total Estimated Monthly Cost (Sales)</h2><div class="total-price" id="salesTotalPrice">£0.00</div><div class="note">Excludes VAT & other apps. Verify official UK pricing.</div></div>
        </form>
    </div>

    <!-- D365 Customer Service Calculator -->
     <div id="custsvc-section" class="page-section">
        <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Dynamics 365 Customer Service Calculator</h1>
        <form id="custsvcForm">
             <div class="card"><h2>Customer Service Licenses (UK Pricing)</h2><p>Enter the number of users required for each license type.</p>
                <div class="config-card">
                     <div class="license-input-group"><label for="custsvcEntUsers"><div>Enterprise Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Full Case Mgt, Omnichannel, Scheduling, Knowledge, SLAs, basic Copilot.</span></span></div><div><span class="price-info">(£<span id="price_custsvcEnt">71.60</span>/u/m)</span><input type="number" id="custsvcEntUsers" min="0" value="10" step="1"></div></label></div>
                     <div class="license-input-group"><label for="custsvcProUsers"><div>Professional Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Core Case Mgt, Knowledge, Queues. Cannot mix with Ent.</span></span></div><div><span class="price-info">(£<span id="price_custsvcPro">37.70</span>/u/m)</span><input type="number" id="custsvcProUsers" min="0" value="0" step="1"></div></label></div>
                    <div class="license-input-group"><label for="custsvcTeamUsers"><div>Team Member Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Lightweight access. Read data, self-service cases, knowledge access. See Guide App C.</span></span></div><div><span class="price-info">(£<span id="price_custsvcTeam">6.00</span>/u/m)</span><input type="number" id="custsvcTeamUsers" min="0" value="0" step="1"></div></label></div>
                </div>
                <div class="feature-table-container"><h3>Feature Highlights</h3><table class="feature-table"><thead><tr><th>Feature Area</th><th>Enterprise</th><th>Professional</th><th>Team Member</th></tr></thead><tbody><tr><td>Case Management</td><td class="check">✔</td><td class="check">✔</td><td class="partial">Self-Svc</td></tr><tr><td>Knowledge Management</td><td class="check">✔</td><td class="check">✔</td><td class="check">✔</td></tr><tr><td>SLAs & Entitlements</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Unified Routing</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Omnichannel (via Add-on)</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Copilot Assist</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr></tbody></table></div>
            </div>
             <div class="card pricing"><h2>Total Estimated Monthly Cost (Customer Service)</h2><div class="total-price" id="custsvcTotalPrice">£0.00</div><div class="note">Excl. VAT & add-ons (Contact Center, Digital Messaging). Verify UK pricing.</div></div>
        </form>
    </div>

    <!-- D365 Field Service Calculator -->
     <div id="fieldsvc-section" class="page-section">
        <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Dynamics 365 Field Service Calculator</h1>
        <form id="fieldsvcForm">
            <div class="grid-container-inputs">
                 <div class="card"><h2>Field Service Licenses (UK Pricing)</h2><p>Enter user/resource counts.</p>
                    <div class="config-card">
                         <div class="license-input-group"><label for="fieldsvcUsers"><div>Field Service Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Full capabilities for technicians/dispatchers. Work Orders, Scheduling, Inventory, Mobile.</span></span></div><div><span class="price-info">(£<span id="price_fieldsvc">71.60</span>/u/m)</span><input type="number" id="fieldsvcUsers" min="0" value="10" step="1"></div></label></div>
                         <div class="license-input-group"><label for="fieldsvcContractorUsers"><div>Contractor Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">For third-party technicians. Limited access via mobile app.</span></span></div><div><span class="price-info">(£<span id="price_fieldsvcContractor">49.00</span>/u/m)</span><input type="number" id="fieldsvcContractorUsers" min="0" value="0" step="1"></div></label></div>
                        <div class="license-input-group"><label for="fieldsvcTeamUsers"><div>Team Member Users <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Lightweight access. Read data, basic activities. See Guide App C.</span></span></div><div><span class="price-info">(£<span id="price_fieldsvcTeam">6.00</span>/u/m)</span><input type="number" id="fieldsvcTeamUsers" min="0" value="0" step="1"></div></label></div>
                    </div>
                     <div class="feature-table-container"><h3>Feature Highlights</h3><table class="feature-table"><thead><tr><th>Feature Area</th><th>Field Service</th><th>Contractor</th><th>Team Member</th></tr></thead><tbody><tr><td>Work Order Management</td><td class="check">✔</td><td class="partial">Limited¹</td><td class="partial">Limited²</td></tr><tr><td>Scheduling Board</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Mobile App (Offline)</td><td class="check">✔</td><td class="check">✔</td><td class="no-check">✘</td></tr><tr><td>Inventory Management</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Asset Management</td><td class="check">✔</td><td class="no-check">✘</td><td class="no-check">✘</td></tr><tr><td>Inspections</td><td class="check">✔</td><td class="check">✔</td><td class="no-check">✘</td></tr></tbody></table><small style="font-size: 0.75rem; opacity: 0.8; display: block; margin-top: 5px;">¹Contractor focused on execution. ²Team Member limited by App C.</small></div>
                </div>
                 <div class="card"><h2>Add-ons</h2>
                    <div class="config-card">
                         <div class="license-input-group"><label for="fieldsvcRsoResources"><div>Resource Scheduling Optimization (RSO) <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Automated scheduling/routing. Licensed per scheduled resource.</span></span></div><div><span class="price-info">(£<span id="price_fieldsvcRso">22.60</span>/res/m)</span><input type="number" id="fieldsvcRsoResources" min="0" value="0" step="1"></div></label></div>
                    </div>
                </div>
            </div>
             <div class="card pricing"><h2>Total Estimated Monthly Cost (Field Service)</h2><div class="total-price" id="fieldsvcTotalPrice">£0.00</div><div class="note">Excl. VAT & other apps. Verify official UK pricing.</div></div>
        </form>
    </div>

    <!-- Power Apps Calculator -->
     <div id="powerapps-section" class="page-section">
        <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Power Apps Calculator</h1>
         <form id="powerappsForm">
             <div class="card"><h2>Power Apps Plans (UK Pricing)</h2><p>Estimate costs for standalone custom apps. D365/M365 licenses may include seeded rights.</p>
                 <div class="config-card"><h3>Subscription Plans</h3>
                     <div class="license-input-group"><label for="powerappsPerAppPasses"><div>Per App Passes <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Allows ONE user access to ONE custom app OR portal. Stack passes.</span></span></div><div><span class="price-info">(£<span id="price_powerappsPerApp">3.80</span>/pass/m)</span><input type="number" id="powerappsPerAppPasses" min="0" value="0" step="1"></div></label></div>
                     <div class="license-input-group"><label for="powerappsPerUserUsers"><div>Per User Licenses <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Allows ONE user access to UNLIMITED custom apps and portals.</span></span></div><div><span class="price-info">(£<span id="price_powerappsPerUser">15.10</span>/user/m)</span><input type="number" id="powerappsPerUserUsers" min="0" value="0" step="1"></div></label></div>
                     <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 15px;">Note: Pay-As-You-Go plan (~£7.54/active user/app/month via Azure) also available.</p>
                </div>
            </div>
             <div class="card pricing"><h2>Total Estimated Monthly Cost (Power Apps)</h2><div class="total-price" id="powerappsTotalPrice">£0.00</div><div class="note">Excl. VAT & Dataverse capacity overages. Verify UK pricing.</div></div>
         </form>
    </div>

    <!-- Power Automate Calculator -->
     <div id="powerautomate-section" class="page-section">
         <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Power Automate Calculator</h1>
          <form id="powerautomateForm">
             <div class="card"><h2>Power Automate Plans (UK Pricing)</h2><p>Estimate costs for standalone automation. D365/M365/Power Apps licenses may include seeded rights.</p>
                 <div class="config-card"><h3>Subscription Plans</h3>
                     <div class="license-input-group"><label for="paPerUserUsers"><div>Per User Plan <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Allows ONE user to run UNLIMITED cloud flows (DPA).</span></span></div><div><span class="price-info">(£<span id="price_paPerUser">11.30</span>/user/m)</span><input type="number" id="paPerUserUsers" min="0" value="0" step="1"></div></label></div>
                     <div class="license-input-group"><label for="paPerUserAttendedRpaUsers"><div>Per User Plan w/ Attended RPA <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Includes Per User plan + attended desktop flows (RPA).</span></span></div><div><span class="price-info">(£<span id="price_paPerUserAttendedRpa">30.20</span>/user/m)</span><input type="number" id="paPerUserAttendedRpaUsers" min="0" value="0" step="1"></div></label></div>
                     <div class="license-input-group"><label for="paPerFlowFlows"><div>Per Flow Plan <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Allows UNLIMITED users to trigger specific flows. Min purchase: 5 flows.</span></span></div><div><span class="price-info">(£<span id="price_paPerFlow">75.40</span>/flow/m)</span><input type="number" id="paPerFlowFlows" min="0" value="0" step="1"></div></label></div>
                     <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 15px;">Note: Unattended RPA and Process Mining add-ons not included.</p>
                 </div>
             </div>
              <div class="card pricing"><h2>Total Estimated Monthly Cost (Power Automate)</h2><div class="total-price" id="powerautomateTotalPrice">£0.00</div><div class="note">Excl. VAT & add-ons. Verify UK pricing.</div></div>
          </form>
     </div>

     <!-- Power Pages Calculator -->
      <div id="powerpages-section" class="page-section">
          <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Power Pages Calculator</h1>
           <form id="powerpagesForm">
              <div class="card"><h2>Power Pages Capacity (UK Pricing)</h2><p>Estimate costs based on monthly external user access per website.</p>
                  <div class="config-card"><h3>Capacity Packs (Per Website)</h3>
                      <div class="license-input-group"><label for="ppAuthUsersPacks"><div>Authenticated Users Packs <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Logged-in external users. Sold in packs of 100 users/site/month.</span></span></div><div><span class="price-info">(£<span id="price_ppAuthPack">150.80</span>/100u/m)</span><input type="number" id="ppAuthUsersPacks" min="0" value="0" step="1"></div></label></div>
                      <div class="license-input-group"><label for="ppAnonUsersPacks"><div>Anonymous Users Packs <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Public visitors. Sold in packs of 500 users/site/month.</span></span></div><div><span class="price-info">(£<span id="price_ppAnonPack">56.50</span>/500u/m)</span><input type="number" id="ppAnonUsersPacks" min="0" value="0" step="1"></div></label></div>
                      <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 15px;">Note: Internal users need Power Apps/D365 licenses. PAYG also available.</p>
                 </div>
             </div>
              <div class="card pricing"><h2>Total Estimated Monthly Cost (Power Pages)</h2><div class="total-price" id="powerpagesTotalPrice">£0.00</div><div class="note">Excl. VAT & Dataverse overages. Verify UK pricing.</div></div>
           </form>
      </div>

    <!-- Customer Insights Section (Existing - unchanged structure) -->
    <div id="ci-section" class="page-section">
        <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Customer Insights Calculator</h1><form id="ciForm"><div class="card"><h2>License Type</h2><div class="radio-group"><label><input type="radio" name="license" value="standard" checked><div> Standard (£1,397.30/mo) <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Base license cost per tenant per month. Includes 100k Unified People and 10k Interacted People.</span></span></div></label><label><input type="radio" name="license" value="attach"><div> Attach (£821.90/mo) <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Reduced base cost available if you have a qualifying Dynamics 365 base license (e.g., Sales Enterprise, Customer Service Enterprise) with a minimum of 10 users.</span></span></div></label></div></div><div class="card"><h2>Unified People <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Total unique customer profiles unified. Base includes 100k. Additional capacity in 100k packs (tiered price).</span></span></h2><input type="range" id="unifiedSlider" min="100000" max="5000000" step="10000" value="100000"><div class="slider-value" id="unifiedValue">100,000 people</div><div id="ci-validation-warning-container"></div></div><div class="card"><h2>Interacted People <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Unique profiles interacted with via activities monthly. Base includes 10k. Additional capacity in tiered packs.</span></span></h2><input type="range" id="interactedSlider" min="10000" max="500000" step="5000" value="10000"><div class="slider-value" id="interactedValue">10,000 people</div></div></form><div id="ciOptimizations" class="card suggestions" style="display: none;"></div><div class="card pricing"><h2>Total Estimated Monthly Cost</h2><div class="total-price" id="totalPrice">£1,397.30</div><div class="breakdown"><div class="breakdown-section"><h3>Base License</h3><div id="baseCost">£1,397.30</div></div><div class="breakdown-section"><h3>Unified People Cost</h3><div id="unifiedBreakdown">Base: 100k (incl.)</div></div><div class="breakdown-section"><h3>Interacted People Cost</h3><div id="interactedBreakdown">Base: 10k (incl.)</div></div></div><div class="note">Excludes VAT. Estimates only.</div></div>
    </div>

    <!-- Copilot Studio Section (Existing - unchanged structure) -->
    <div id="cs-section" class="page-section">
         <a onclick="showCalculator('index-section'); return false;" class="back-link">← Back</a><h1>Copilot Studio Calculator</h1><div class="card"><div class="example-box"><h3 style="margin-top: 0;">How Pricing Works</h3><p>Costs are based on message consumption. Choose between pre-paid Message Packs or Pay-As-You-Go. Different actions consume different message amounts.</p><p><strong>Note:</strong> Usage by licensed M365 Copilot users within M365 apps is free.</p></div><form id="copilotForm"><div class="grid-container-inputs"><div><h2>Agent Configuration (Per Run)</h2><div class="config-card"><h3>Answers</h3><div class="number-input"><label for="classicAnswers">Classic Answers <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Rule-based. Cost: 1 msg/answer.</span></span></label><input type="number" id="classicAnswers" min="0" value="0" step="1"></div><div class="number-input"><label for="generativeAnswers">Generative Answers <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">AI-generated. Cost: 2 msgs/answer.</span></span></label><input type="number" id="generativeAnswers" min="0" value="0" step="1"></div><h3>Actions</h3><div class="number-input"><label for="agentActions">Agent Actions <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">External tasks. Cost: 5 msgs/action.</span></span></label><input type="number" id="agentActions" min="0" value="0" step="1"></div><div class="number-input"><label for="tenantGraph">Tenant Graph <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">M365 data access. Cost: 10 msgs/action.</span></span></label><input type="number" id="tenantGraph" min="0" value="0" step="1"></div> <div class="number-input"><label for="agentFlowActions">Flow Actions <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Flow runs. Cost: 13 msgs/100 actions. Enter total Flow actions expected per run.</span></span></label><input type="number" id="agentFlowActions" min="0" value="0" step="1"></div><h3>AI Tools (Per 10 Responses)</h3> <div class="number-input"><label for="basicAITools">Basic AI Tools <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Simple AI. Cost: 1 msg/10 responses. Enter # responses.</span></span></label><input type="number" id="basicAITools" min="0" value="0" step="1"></div> <div class="number-input"><label for="standardAITools">Standard AI Tools <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Medium AI. Cost: 15 msgs/10 responses. Enter # responses.</span></span></label><input type="number" id="standardAITools" min="0" value="0" step="1"></div> <div class="number-input"><label for="premiumAITools">Premium AI Tools <span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Advanced AI. Cost: 100 msgs/10 responses. Enter # responses.</span></span></label><input type="number" id="premiumAITools" min="0" value="0" step="1"></div></div><h2>Usage Volume</h2><div class="config-card"><div class="number-input" style="flex-direction: column; align-items: stretch;"><label for="monthlyRuns">Total Monthly Agent Runs<span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Total conversations/sessions per month across all users.</span></span></label><input type="number" id="monthlyRuns" min="1" value="1000" step="100"></div><div class="m365-option checkbox-group"><label><input type="checkbox" id="m365Users"> Include Free Runs by M365 Copilot Users?<span class="tooltip"><span class="icon-info" tabindex="0">i</span><span class="tooltip-text">Check if some/all runs are by users with M365 Copilot licenses. Their usage within M365 apps doesn't count towards billable messages.</span></span></label><div id="m365Percentage" style="display: none; padding-top: 15px; margin-top:15px; border-top: 1px dashed var(--border-color);"><label for="m365PercentSlider">Percentage of Runs by M365 Copilot Users:</label><input type="range" id="m365PercentSlider" min="0" max="100" step="5" value="0"><div class="slider-value" id="m365PercentValue">0%</div></div></div></div></div><div><h2>Results Summary</h2><div class="card" style="padding: 0; overflow: hidden; backdrop-filter: none; background: transparent; border: none; box-shadow: none;"><table class="pricing-table"><thead><tr><th>Action Type (Per Run)</th><th>Count</th><th>Messages</th></tr></thead><tbody><tr><td>Classic Answers</td><td id="classicAnswersCount">0</td><td id="classicAnswersMessages">0</td></tr><tr><td>Generative Answers</td><td id="generativeAnswersCount">0</td><td id="generativeAnswersMessages">0</td></tr><tr><td>Agent Actions</td><td id="agentActionsCount">0</td><td id="agentActionsMessages">0</td></tr><tr><td>Tenant Graph</td><td id="tenantGraphCount">0</td><td id="tenantGraphMessages">0</td></tr><tr><td>Flow Actions</td><td id="agentFlowActionsCount">0</td><td id="agentFlowActionsMessages">0</td></tr><tr><td>Basic AI Resp.</td><td id="basicAIToolsCount">0</td><td id="basicAIToolsMessages">0</td></tr><tr><td>Standard AI Resp.</td><td id="standardAIToolsCount">0</td><td id="standardAIToolsMessages">0</td></tr><tr><td>Premium AI Resp.</td><td id="premiumAIToolsCount">0</td><td id="premiumAIToolsMessages">0</td></tr><tr class="total-row"><td colspan="2">Est. Messages Per Run</td><td id="totalMessagesPerRun">0</td></tr></tbody></table></div><div class="option-container"><div class="option-card"><div class="option-title">Total Runs /mo</div><div class="option-value" id="monthlyRunsDisplay">1k</div></div><div class="option-card" id="m365RunsCard" style="display: none;"><div class="option-title">Free Runs /mo</div><div class="option-value" id="m365RunsDisplay">0</div></div><div class="option-card"><div class="option-title">Billable Runs /mo</div><div class="option-value" id="billableRunsDisplay">1k</div></div><div class="option-card"><div class="option-title">Billable Msgs /mo</div><div class="option-value" id="totalMonthlyMessages">0</div></div></div><div class="card pricing"><h2>Monthly Cost Estimate</h2><div class="option-container" style="grid-template-columns: 1fr 1fr;"><div><h3>Message Packs</h3><div>Packs Req: <strong id="messagePacksRequired">0</strong></div><div>Cost: <strong style="font-size: 1.1rem;">£<span id="messagePackCost">0.00</span></strong></div><div style="font-size: 0.8rem; opacity: 0.8;">(£161.49 / 25k msgs)</div></div><div><h3>Pay-As-You-Go</h3><div>Messages: <strong id="paygoMessages">0</strong></div><div>Cost: <strong style="font-size: 1.1rem;">£<span id="paygoCost">0.00</span></strong></div><div style="font-size: 0.8rem; opacity: 0.8;">(£0.01 / msg)</div></div></div><div class="cost-comparison" id="costComparison"></div><div class="note">Excludes VAT. Estimates only.</div></div></div></div></form></div>
    </div>

</div> <!-- End App Container -->

    <script>
    // --- Global Scope & Helpers ---
    const body = document.body;
    function showCalculator(sectionIdToShow) { document.querySelectorAll('.page-section').forEach(s => s.classList.toggle('active', s.id === sectionIdToShow)); window.scrollTo({ top: 0, behavior: 'smooth' }); }
    let rafId; let mouseX = window.innerWidth / 2; let mouseY = window.innerHeight / 2; let targetMouseX = mouseX; let targetMouseY = mouseY; const lerpFactor = 0.08;
    function updateMousePosition(event) { targetMouseX = event.clientX; targetMouseY = event.clientY; if (!rafId) rafId = requestAnimationFrame(animateBackground); }
    function lerp(start, end, factor) { return start + (end - start) * factor; }
    function animateBackground() { mouseX = lerp(mouseX, targetMouseX, lerpFactor); mouseY = lerp(mouseY, targetMouseY, lerpFactor); const xP = (mouseX / window.innerWidth) * 100, yP = (mouseY / window.innerHeight) * 100; body.style.setProperty('--mouse-x', `${xP}%`); body.style.setProperty('--mouse-y', `${yP}%`); if (Math.abs(mouseX - targetMouseX) < 0.1 && Math.abs(mouseY - targetMouseY) < 0.1) { cancelAnimationFrame(rafId); rafId = null; } else { rafId = requestAnimationFrame(animateBackground); } }
    window.addEventListener('mousemove', updateMousePosition, { passive: true });
    function formatCurrency(value, currency = 'GBP') { return value.toLocaleString('en-GB', { style: 'currency', currency: currency, minimumFractionDigits: 2, maximumFractionDigits: 2 }); }
    function formatNumber(value, compact = false) { if (compact && value >= 1000000) return (value / 1000000).toFixed(1) + 'M'; if (compact && value >= 1000) return (value / 1000).toFixed(0) + 'k'; return value.toLocaleString('en-GB'); }

    // --- Generic License Calculator Function ---
    function initializeLicenseCalculator(sectionId, licenseConfig, resultElementId) { const section = document.getElementById(sectionId); if (!section) return; const resultElement = section.querySelector(`#${resultElementId}`); if (!resultElement) return; const elements = {}; function updateCalculation() { let totalCost = 0; for (const key in licenseConfig) { const config = licenseConfig[key]; const inputElement = elements[config.inputId]; const userCount = inputElement ? (parseInt(inputElement.value) || 0) : 0; totalCost += userCount * config.price; } resultElement.textContent = formatCurrency(totalCost); } for (const key in licenseConfig) { const config = licenseConfig[key]; const priceElement = section.querySelector(`#${config.priceId}`); const inputElement = section.querySelector(`#${config.inputId}`); if (priceElement) priceElement.textContent = config.price.toFixed(2); if (inputElement) { elements[config.inputId] = inputElement; inputElement.addEventListener('input', updateCalculation); } } updateCalculation(); }

    // --- D365 Sales Calculator ---
    (function() { initializeLicenseCalculator('sales-section', { prem: { price: 101.80, inputId: 'salesPremUsers', priceId: 'price_salesPrem' }, ent: { price: 71.60, inputId: 'salesEntUsers', priceId: 'price_salesEnt' }, pro: { price: 49.00, inputId: 'salesProUsers', priceId: 'price_salesPro' }, team: { price: 6.00, inputId: 'salesTeamUsers', priceId: 'price_salesTeam' } }, 'salesTotalPrice'); })();

    // --- D365 Customer Service Calculator ---
    (function() { initializeLicenseCalculator('custsvc-section', { ent: { price: 71.60, inputId: 'custsvcEntUsers', priceId: 'price_custsvcEnt' }, pro: { price: 37.70, inputId: 'custsvcProUsers', priceId: 'price_custsvcPro' }, team: { price: 6.00, inputId: 'custsvcTeamUsers', priceId: 'price_custsvcTeam' } }, 'custsvcTotalPrice'); })();

    // --- D365 Field Service Calculator ---
    (function() { const section = document.getElementById('fieldsvc-section'); if (!section) return; const resultElement = section.querySelector('#fieldsvcTotalPrice'); if (!resultElement) return; const config = { fs: { price: 71.60, inputId: 'fieldsvcUsers', priceId: 'price_fieldsvc' }, contractor: { price: 49.00, inputId: 'fieldsvcContractorUsers', priceId: 'price_fieldsvcContractor' }, team: { price: 6.00, inputId: 'fieldsvcTeamUsers', priceId: 'price_fieldsvcTeam' }, rso: { price: 22.60, inputId: 'fieldsvcRsoResources', priceId: 'price_fieldsvcRso' } }; const elements = {}; function updateFieldSvcCalculation() { let totalCost = 0; totalCost += (parseInt(elements.fieldsvcUsers?.value) || 0) * config.fs.price; totalCost += (parseInt(elements.fieldsvcContractorUsers?.value) || 0) * config.contractor.price; totalCost += (parseInt(elements.fieldsvcTeamUsers?.value) || 0) * config.team.price; totalCost += (parseInt(elements.fieldsvcRsoResources?.value) || 0) * config.rso.price; resultElement.textContent = formatCurrency(totalCost); } for (const key in config) { const cfg = config[key]; const priceEl = section.querySelector(`#${cfg.priceId}`); const inputEl = section.querySelector(`#${cfg.inputId}`); if(priceEl) priceEl.textContent = cfg.price.toFixed(2); if(inputEl) { elements[cfg.inputId] = inputEl; inputEl.addEventListener('input', updateFieldSvcCalculation); } } updateFieldSvcCalculation(); })();

    // --- Power Apps Calculator ---
    (function() { initializeLicenseCalculator('powerapps-section', { perApp: { price: 3.80, inputId: 'powerappsPerAppPasses', priceId: 'price_powerappsPerApp' }, perUser: { price: 15.10, inputId: 'powerappsPerUserUsers', priceId: 'price_powerappsPerUser' } }, 'powerappsTotalPrice'); })();

    // --- Power Automate Calculator ---
    (function() { initializeLicenseCalculator('powerautomate-section', { perUser: { price: 11.30, inputId: 'paPerUserUsers', priceId: 'price_paPerUser' }, attended: { price: 30.20, inputId: 'paPerUserAttendedRpaUsers', priceId: 'price_paPerUserAttendedRpa' }, perFlow: { price: 75.40, inputId: 'paPerFlowFlows', priceId: 'price_paPerFlow' } }, 'powerautomateTotalPrice'); })();

    // --- Power Pages Calculator ---
    (function() { initializeLicenseCalculator('powerpages-section', { auth: { price: 150.80, inputId: 'ppAuthUsersPacks', priceId: 'price_ppAuthPack' }, anon: { price: 56.50, inputId: 'ppAnonUsersPacks', priceId: 'price_ppAnonPack' } }, 'powerpagesTotalPrice'); })();

    // --- Customer Insights Calculator JS (scoped - unchanged structure) ---
    (function() { const ciSection = document.getElementById('ci-section'); if (!ciSection) return; let ciLicenseType = 'standard', ciUnifiedPeople = 100000, ciInteractedPeople = 10000; const unifiedSlider = ciSection.querySelector('#unifiedSlider'), unifiedValueDisplay = ciSection.querySelector('#unifiedValue'), interactedSlider = ciSection.querySelector('#interactedSlider'), interactedValueDisplay = ciSection.querySelector('#interactedValue'), licenseRadios = ciSection.querySelectorAll('input[name="license"]'), totalPriceDisplay = ciSection.querySelector('#totalPrice'), baseCostDisplay = ciSection.querySelector('#baseCost'), unifiedBreakdownDisplay = ciSection.querySelector('#unifiedBreakdown'), interactedBreakdownDisplay = ciSection.querySelector('#interactedBreakdown'), optimizationsDisplay = ciSection.querySelector('#ciOptimizations'), validationContainer = ciSection.querySelector('#ci-validation-warning-container'); const BASE_COSTS = { standard: 1397.30, attach: 821.90 }, BASE_UNIFIED = 100000, BASE_INTERACTED = 10000, UNIFIED_TIERS = [{ limit: 500000, price: 1643.90 }, { limit: 2000000, price: 1232.90 }, { limit: Infinity, price: 821.90 }], UNIFIED_PACK_SIZE = 100000, INTERACTED_TIERS = [{ limit: 50000, price: 205.50, size: 5000 }, { limit: 250000, price: 246.60, size: 10000 }, { limit: Infinity, price: 411.00, size: 50000 }]; licenseRadios.forEach(radio => radio.addEventListener('change', (e) => { ciLicenseType = e.target.value; updateCiCalculations(); })); unifiedSlider.addEventListener('input', (e) => { ciUnifiedPeople = parseInt(e.target.value); unifiedValueDisplay.textContent = `${formatNumber(ciUnifiedPeople, true)} people`; checkCiValidation(); updateCiCalculations(); }); interactedSlider.addEventListener('input', (e) => { ciInteractedPeople = parseInt(e.target.value); interactedValueDisplay.textContent = `${formatNumber(ciInteractedPeople, true)} people`; checkCiValidation(); updateCiCalculations(); }); function checkCiValidation() { validationContainer.innerHTML = ''; if (ciInteractedPeople > ciUnifiedPeople) { const w = document.createElement('div'); w.className = 'warning'; w.innerHTML = `<strong>Warning:</strong> Interacted People (${formatNumber(ciInteractedPeople, true)}) cannot exceed Unified People (${formatNumber(ciUnifiedPeople, true)}).`; validationContainer.appendChild(w); return false; } return true; } function calculateCiUnifiedCost(tp) { if (tp <= BASE_UNIFIED) return { cost: 0, packs: 0, ppp: 0, tierInfo: "Base" }; const add = tp - BASE_UNIFIED, tier = UNIFIED_TIERS.find(t => tp <= t.limit) || UNIFIED_TIERS[UNIFIED_TIERS.length - 1], packs = Math.ceil(add / UNIFIED_PACK_SIZE), cost = packs * tier.price, tierInfo = `Tier ${UNIFIED_TIERS.indexOf(tier) + 1}`; return { cost, packs, ppp: tier.price, tierInfo }; } function calculateCiInteractedCost(tp) { if (tp <= BASE_INTERACTED) return { cost: 0, packs: 0, ps: 0, ppp: 0, tierInfo: "Base" }; const add = tp - BASE_INTERACTED, tier = INTERACTED_TIERS.find(t => tp <= t.limit) || INTERACTED_TIERS[INTERACTED_TIERS.length - 1], packs = Math.ceil(add / tier.size), cost = packs * tier.price, tierInfo = `Tier ${INTERACTED_TIERS.indexOf(tier) + 1}`; return { cost, packs, ps: tier.size, ppp: tier.price, tierInfo }; } function findCiOptimizations(isValid) { if (!isValid) return []; const opts = []; if (ciLicenseType === 'standard') opts.push(`Consider 'Attach' license if eligible to save ${formatCurrency(BASE_COSTS.standard - BASE_COSTS.attach)}/mo base cost.`); if (ciUnifiedPeople > BASE_UNIFIED) { const cc = calculateCiUnifiedCost(ciUnifiedPeople), cti = UNIFIED_TIERS.findIndex(t => ciUnifiedPeople <= t.limit); if (cti < UNIFIED_TIERS.length - 1) { const ntS = UNIFIED_TIERS[cti].limit + 1, cnS = calculateCiUnifiedCost(ntS).cost; if (cnS < cc.cost) opts.push(`Unified: Increasing to ${formatNumber(ntS, true)} might lower pack cost.`); } } if (ciInteractedPeople > BASE_INTERACTED) { const cc = calculateCiInteractedCost(ciInteractedPeople), cti = INTERACTED_TIERS.findIndex(t => ciInteractedPeople <= t.limit); if (cti < INTERACTED_TIERS.length - 1) { const ntS = INTERACTED_TIERS[cti].limit + 1, cnS = calculateCiInteractedCost(ntS).cost; if (cnS < cc.cost) opts.push(`Interacted: Increasing to ${formatNumber(ntS, true)} might lower pack cost.`); } } return opts; } function updateCiCalculations() { const isValid = checkCiValidation(), baseCost = BASE_COSTS[ciLicenseType], uR = calculateCiUnifiedCost(ciUnifiedPeople), iR = calculateCiInteractedCost(ciInteractedPeople), totalCost = isValid ? baseCost + uR.cost + iR.cost : baseCost; totalPriceDisplay.textContent = formatCurrency(totalCost) + (isValid ? "" : " (Invalid Config)"); baseCostDisplay.textContent = `${formatCurrency(baseCost)} (${ciLicenseType})`; unifiedBreakdownDisplay.innerHTML = `Base: ${formatNumber(BASE_UNIFIED, true)} (incl.)` + (uR.packs > 0 ? `<br>+ ${formatNumber(uR.packs)} packs (${uR.tierInfo}) | <strong>${formatCurrency(uR.cost)}</strong>` : `<br>Add. Cost: <strong>${formatCurrency(0)}</strong>`); interactedBreakdownDisplay.innerHTML = `Base: ${formatNumber(BASE_INTERACTED, true)} (incl.)` + (iR.packs > 0 ? `<br>+ ${formatNumber(iR.packs)} packs (${iR.tierInfo}) | <strong>${formatCurrency(iR.cost)}</strong>` : `<br>Add. Cost: <strong>${formatCurrency(0)}</strong>`); const opts = findCiOptimizations(isValid); if (opts.length > 0) { optimizationsDisplay.innerHTML = `<h2>Optimization Suggestions</h2>${opts.map(opt => `<div class="suggestion">${opt}</div>`).join('')}`; optimizationsDisplay.style.display = 'block'; } else { optimizationsDisplay.style.display = 'none'; } } unifiedValueDisplay.textContent = `${formatNumber(ciUnifiedPeople, true)} people`; interactedValueDisplay.textContent = `${formatNumber(ciInteractedPeople, true)} people`; updateCiCalculations(); })();

    // --- Copilot Studio Calculator JS (scoped - unchanged structure) ---
     (function() { const csSection = document.getElementById('cs-section'); if (!csSection) return; const MESSAGE_RATES = { classicAnswer: 1, generativeAnswer: 2, agentAction: 5, tenantGraph: 10, agentFlowActions: 0.13, basicAITools: 0.1, standardAITools: 1.5, premiumAITools: 10 }, PACK_SIZE = 25000, PACK_PRICE_GBP = 161.49, PAYGO_RATE_GBP = 0.01; const elements = Object.fromEntries(Array.from(csSection.querySelectorAll('[id]')).map(el => [el.id, el])); const getVal = (id) => parseInt(elements[id]?.value) || 0; const setTxt = (id, val, fmt = formatNumber) => { if(elements[id]) elements[id].textContent = fmt(val); }; function updateCsCalculation() { const ca = getVal('classicAnswers'), ga = getVal('generativeAnswers'), aa = getVal('agentActions'), tg = getVal('tenantGraph'), fa = getVal('agentFlowActions'), ba = getVal('basicAITools'), sa = getVal('standardAITools'), pa = getVal('premiumAITools'), mo = getVal('monthlyRuns'); const mc = ca*MESSAGE_RATES.classicAnswer, mg = ga*MESSAGE_RATES.generativeAnswer, ma = aa*MESSAGE_RATES.agentAction, mt = tg*MESSAGE_RATES.tenantGraph, mf = fa*MESSAGE_RATES.agentFlowActions, mb = ba*MESSAGE_RATES.basicAITools, ms = sa*MESSAGE_RATES.standardAITools, mp = pa*MESSAGE_RATES.premiumAITools; const tpr = Math.round((mc + mg + ma + mt + mf + mb + ms + mp) * 100) / 100; const um = elements.m365Users.checked, mpct = um ? (parseInt(elements.m365PercentSlider.value) / 100) : 0, mr = Math.round(mo * mpct), br = Math.max(0, mo - mr), tmb = Math.ceil(tpr * br); const pr = tmb > 0 ? Math.ceil(tmb / PACK_SIZE) : 0, pc = pr * PACK_PRICE_GBP, pyp = tmb * PAYGO_RATE_GBP; setTxt('classicAnswersCount', ca); setTxt('classicAnswersMessages', Math.ceil(mc)); setTxt('generativeAnswersCount', ga); setTxt('generativeAnswersMessages', Math.ceil(mg)); setTxt('agentActionsCount', aa); setTxt('agentActionsMessages', Math.ceil(ma)); setTxt('tenantGraphCount', tg); setTxt('tenantGraphMessages', Math.ceil(mt)); setTxt('agentFlowActionsCount', fa); setTxt('agentFlowActionsMessages', Math.ceil(mf)); setTxt('basicAIToolsCount', ba); setTxt('basicAIToolsMessages', Math.ceil(mb)); setTxt('standardAIToolsCount', sa); setTxt('standardAIToolsMessages', Math.ceil(ms)); setTxt('premiumAIToolsCount', pa); setTxt('premiumAIToolsMessages', Math.ceil(mp)); setTxt('totalMessagesPerRun', Math.ceil(tpr)); setTxt('monthlyRunsDisplay', mo, (v)=>formatNumber(v,true)); setTxt('m365RunsDisplay', mr, (v)=>formatNumber(v,true)); setTxt('billableRunsDisplay', br, (v)=>formatNumber(v,true)); setTxt('totalMonthlyMessages', tmb, (v)=>formatNumber(v,true)); setTxt('messagePacksRequired', pr); setTxt('messagePackCost', pc, (v)=>formatCurrency(v,'GBP').substring(1)); setTxt('paygoMessages', tmb, (v)=>formatNumber(v,true)); setTxt('paygoCost', pyp, (v)=>formatCurrency(v,'GBP').substring(1)); updateCsCostComparison(tmb, pr, pc, pyp); } function updateCsCostComparison(tm, pr, pc, pyp) { let html = ''; const ce = elements.costComparison; if (!ce) return; if (tm === 0) { html = `<p style="text-align: center; color: var(--text-secondary); width: 100%;">Configure agent & usage.</p>`; } else { const pyc = pyp < pc, savings = Math.abs(pc - pyp), st = savings > 0.01 ? `<div class="savings">Saves ${formatCurrency(savings)}</div>` : ''; const pkh = `<div class="cost-option ${!pyc ? 'cheaper' : 'more-expensive'}"><strong>${!pyc ? 'Recommended' : ''} Message Packs</strong>£${formatCurrency(pc,'GBP').substring(1)}<small style="display: block; opacity: 0.7;">(${formatNumber(pr)} pack${pr !== 1 ? 's' : ''})</small>${!pyc ? st : ''}</div>`; const pyh = `<div class="cost-option ${pyc ? 'cheaper' : 'more-expensive'}"><strong>${pyc ? 'Recommended' : ''} Pay-As-You-Go</strong>£${formatCurrency(pyp,'GBP').substring(1)}<small style="display: block; opacity: 0.7;">(${formatNumber(tm, true)} msgs)</small>${pyc ? st : ''}</div>`; html = pyc ? pyh + pkh : pkh + pyh; } ce.innerHTML = html; } const csIF = ['classicAnswers', 'generativeAnswers', 'agentActions', 'tenantGraph', 'agentFlowActions', 'basicAITools', 'standardAITools', 'premiumAITools', 'monthlyRuns', 'm365PercentSlider']; csIF.forEach(id => elements[id]?.addEventListener('input', updateCsCalculation)); elements.m365Users?.addEventListener('change', function() { const sm = this.checked; elements.m365Percentage.style.display = sm ? 'block' : 'none'; elements.m365RunsCard.style.display = sm ? 'block' : 'none'; if (!sm) { elements.m365PercentSlider.value = 0; elements.m365PercentValue.textContent = '0%'; } updateCsCalculation(); }); elements.m365PercentSlider?.addEventListener('input', function() { elements.m365PercentValue.textContent = this.value + '%'; }); updateCsCalculation(); })();

    // --- Initial Page Load ---
     document.addEventListener('DOMContentLoaded', () => { showCalculator('index-section'); });

    </script>

</body>
</html>